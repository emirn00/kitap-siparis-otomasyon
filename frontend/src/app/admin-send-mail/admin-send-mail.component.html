<div class="admin-container">
  <div class="hueber-header">
    <div class="logo-container">
      <h1 class="hueber-logo">HUEBER</h1>
      <h2 class="header-subtitle">{{ 'sendMailSubtitle' | translate }}</h2>
      <a routerLink="/admin" class="help-link">{{ 'adminHome' | translate }}</a>
    </div>
  </div>

  <mat-card class="form-card">
    <mat-card-content>
      <h2 class="section-title">{{ 'sendMailSectionTitle' | translate }}</h2>
      <p class="section-description">
        {{ 'sendMailSectionDesc' | translate }}
      </p>

      <div *ngIf="successMessage" class="alert alert-success">
        <span>{{ successMessage }}</span>
      </div>

      <div class="input-section">
        <mat-form-field appearance="outline" class="emails-field">
          <mat-label>{{ 'recipientEmailsLabel' | translate }}</mat-label>
          <textarea
            matInput
            [(ngModel)]="emailsInput"
            [ngModelOptions]="{ standalone: true }"
            rows="4"
            placeholder="ornek1@okul.edu.tr, ornek2@okul.edu.tr"></textarea>
        </mat-form-field>
        <button mat-raised-button color="primary" type="button" (click)="buildPreview()" class="build-preview-btn">
          {{ 'buildPreview' | translate }}
        </button>
      </div>

      <div class="preview-section" *ngIf="previewRows.length > 0">
        <h3 class="preview-title">{{ 'previewTitle' | translate }}</h3>
        <div class="preview-table-wrap">
          <table class="preview-table">
            <thead>
              <tr>
                <th>{{ 'nameColumn' | translate }}</th>
                <th>{{ 'email' | translate }}</th>
                <th>{{ 'bookCodesColumn' | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let row of previewRows; let i = index">
                <td>
                  <input
                    class="table-input"
                    [(ngModel)]="row.fullName"
                    [ngModelOptions]="{ standalone: true }"
                    [placeholder]="'namePlaceholder' | translate">
                </td>
                <td><span class="email-cell">{{ row.email }}</span></td>
                <td>
                  <input
                    class="table-input table-input-codes"
                    [(ngModel)]="row.bookCodes"
                    [ngModelOptions]="{ standalone: true }"
                    [placeholder]="'codesPlaceholder' | translate">
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="send-actions" *ngIf="!showConfirm">
          <button mat-raised-button color="primary" type="button" (click)="openConfirm()" class="send-btn">
            {{ 'sendMailBtn' | translate }}
          </button>
        </div>

        <div class="confirm-box" *ngIf="showConfirm">
          <p class="confirm-text">{{ 'confirmSendText' | translate }}</p>
          <div class="confirm-actions">
            <button mat-raised-button color="primary" type="button" (click)="confirmSend()">
              {{ 'yesSend' | translate }}
            </button>
            <button mat-button type="button" (click)="cancelSend()">
              {{ 'cancel' | translate }}
            </button>
          </div>
        </div>
      </div>

      <div class="empty-preview" *ngIf="previewRows.length === 0 && !successMessage">
        <p>{{ 'emptyPreviewHint' | translate }}</p>
      </div>
    </mat-card-content>
  </mat-card>
</div>
